<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="Author" content="Ishaque Junejo">
    <meta name="description" content="I tried to work on a Neural Network to understand how it works">
    <meta name="keywords" content="Neural Networks, MNIST, AI, Learning In Progress, Back Propagation, First AI, First Neural Network">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="ishaqjunejo.github.io">
    <meta name="twitter:creator:id" content="@mij_games">
    <meta name="twitter:title" content="Working on my First Neural Network - Ishaque Junejo">
    <meta name="twitter:description" content="I tried to work on a Neural Network to understand how it works">
    <meta name="twitter:images" content="https://ishaqjunejo.github.io/Blogs/images/First-Neural-Network-Banner.png">
    <meta name="og:title" content="Working on my First Neural Network - Ishaque Junejo">
    <meta name="og:description" content="I tried to work on a Neural Network to understand how it works">
    <meta name="og:image" content="https://ishaqjunejo.github.io/Blogs/images/First-Neural-Network-Banner.png">
    <link rel="stylesheet" href="../../style/blogs.css">
    <link rel="stylesheet" href="../../style/nav-bar.css">
    <link rel="stylesheet" href="../../style/code.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="icon" href="../../images/Logo.png">
    <title>Working on my First Neural Network - Ishaque Junejo</title> 
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-240697963-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-240697963-1');
    </script>
</head>
<body>
    <nav>
        <div class="logo">
            <a href="../../">
                <img src="../../images/Logo.png" alt="Home-Page">
            </a>
        </div>
        <ul>
            <li id="bars"><i class="fa fa-bars" onclick="NavBar()"></i></li>
            <li class="nav-links"><a href="../../#home" onclick="CloseNav()">Home</a></li>
            <li class="nav-links"><a href="../../#projects" onclick="CloseNav()">Projects</a></li>
            <li class="nav-links"><a href="../../#pixel-art" onclick="CloseNav()">Pixel Art</a></li>
            <li class="nav-links"><a href="../../#blogs" onclick="CloseNav()">Blogs</a></li>
        </ul>
    </nav>
    <div class="main-container">
        <img src="../images/First-Neural-Network-Banner.png" alt="Banner Images" class="banner">
        <h1 class="title">Working on my First Neural Network</h1>
        <div class="content">
            <p class="date">26-September-2023</p>
            <p>
                I recently tried to make a pretty simple and small Neural Network to understand
                how Neural Networks work, specifically how Neural Networks are Trained with Backpropagation.
            </p>
            <p>
                The Code that was written is mainly from a YouTube Video by <a href="https://youtu.be/w8yWXqWQYmU?si=V5BtzgJ24HABIUsu">Samson Zhang</a> explaining how
                Neural Networks can be built from Scratch without using Libraries like Tensorflow.
            </p>
            <h3>Main Program</h3>
            <p>So the Neural Network was for Identifying Digits of 28 by 28 pixels from the MNIST Dataset (Modified National Institute of Standards and Technology Dataset).
                They have thousands of Labeled Hand Written Digits that can be used for Training my Neural Network and also for Testing it.
            </p>
            <p>
                The structure of this Neural Network is 784 inputs 10 Neurons in the Hidden Layer and 10 Neurons in the Output Layer.
            </p>
            <p>
                What we now need to do is to Read the Data from a CSV file and convert it into a NumPy Array.
            </p>
            <div class="code">
                <pre>
                    <code class="language-python">
<keyword class="comment"># Importing the Dataset</keyword>
data <keyword class="operation">=</keyword> <keyword class="from-class">pd</keyword><keyword class="operation">.</keyword><keyword class="function">read_csv</keyword><keyword class="braces">(</keyword><keyword class="quotes">'Data/mnist_train.csv'</keyword><keyword class="braces">)</keyword>

data <keyword class="operation">=</keyword> <keyword class="from-class">np</keyword><keyword class="operation">.</keyword><keyword class="function">array</keyword><keyword class="braces">(</keyword>data<keyword class="braces">)</keyword>
                    </code>
                </pre>
            </div>
            <p>
                Shuffle It and divide it into Training Data and Testing Data.
            </p>
            <div class="code">
                <pre>
                    <code class="language-python">
m<keyword class="operation">,</keyword> n <keyword class="operation">=</keyword> data<keyword class="operation">.</keyword>shape
<keyword class="from-class">np</keyword><keyword class="operation">.</keyword><keyword class="from-class">random</keyword><keyword class="operation">.</keyword><keyword class="function">shuffle</keyword><keyword class="braces">(</keyword>data<keyword class="braces">)</keyword>

data_test <keyword class="operation">=</keyword> data<keyword class="braces">[</keyword><keyword class="numbers">0</keyword><keyword class="operation">:</keyword>1000<keyword class="braces">]</keyword><keyword class="operation">.T</keyword>
Y_test <keyword class="operation">=</keyword> data_test<keyword class="braces">[</keyword><keyword class="numbers">0</keyword><keyword class="braces">]</keyword>
X_test <keyword class="operation">=</keyword> data_test<keyword class="braces">[</keyword><keyword class="numbers">1</keyword><keyword class="operation">:</keyword>n<keyword class="braces">]</keyword>
X_test <keyword class="operation">=</keyword> X_test <keyword class="operation">/</keyword> <keyword class="numbers">255</keyword>
                        
data_train <keyword class="operation">=</keyword> data<keyword class="braces">[</keyword><keyword class="numbers">1000</keyword><keyword class="operation">:</keyword>m<keyword class="braces">]</keyword><keyword class="operation">.T</keyword>
Y_train <keyword class="operation">=</keyword> data_train<keyword class="braces">[</keyword><keyword class="numbers">0</keyword><keyword class="braces">]</keyword>
X_train <keyword class="operation">=</keyword> data_train<keyword class="braces">[</keyword><keyword class="numbers">1</keyword><keyword class="operation">:</keyword>n<keyword class="braces">]</keyword>
X_train <keyword class="operation">=</keyword> X_train <keyword class="operation">/</keyword> <keyword class="numbers">255</keyword>
                    </code>
                </pre>
            </div>
            <p>
                Define ReLU (Rectified Linear Unit) and SoftMax Activations.
            </p>
            <div class="code">
                <pre>
                    <code class="language-python">
<keyword class="comment"># Activation Function Rectified Linear Unit (ReLU)</keyword>
<keyword class="reserve-1">def</keyword> <keyword class="function">ReLU</keyword><keyword class="braces">(</keyword>x<keyword class="braces">)</keyword><keyword class="operation">:</keyword>
    <keyword class="reserve-2">return</keyword> <keyword class="from-class">np</keyword><keyword class="operation">.</keyword><keyword class="function">maximum</keyword><keyword class="braces">(</keyword>x<keyword class="operation">,</keyword> <keyword class="numbers">0</keyword><keyword class="braces">)</keyword>

<keyword class="comment"># Activation Function Softmax</keyword>
<keyword class="reserve-1">def</keyword> <keyword class="function">softmax</keyword><keyword class="braces">(</keyword>z<keyword class="braces">)</keyword><keyword class="operation">:</keyword>
    a <keyword class="operation">=</keyword> <keyword class="from-class">np</keyword><keyword class="operation">.</keyword><keyword class="function">exp</keyword><keyword class="braces">(</keyword>z<keyword class="braces">)</keyword> <keyword class="operation">/</keyword> <keyword class="function">sum</keyword><keyword class="braces">(</keyword><keyword class="from-class">np</keyword><keyword class="operation">.</keyword><keyword class="function">exp</keyword><keyword class="braces">(</keyword>z<keyword class="braces">))</keyword>
    <keyword class="reserve-2">return</keyword> a
                    </code>
                </pre>
            </div>
            <p>
                Initialize the Weights and Biases in the form of NumPy Arrays at random.
            </p>
            <div class="code">
                <pre>
                    <code class="language-python">
<keyword class="comment"># Function to Initialize the Parameters at Random</keyword>
<keyword class="reserve-1">def</keyword> <keyword class="function">init_parameters</keyword><keyword class="braces">()</keyword><keyword class="operation">:</keyword>
    weights_01 <keyword class="operation">=</keyword> <keyword class="from-class">np</keyword><keyword class="operation">.</keyword><keyword class="from-class">random</keyword><keyword class="operation">.</keyword><keyword class="function">rand</keyword><keyword class="braces">(</keyword><keyword class="numbers">10</keyword><keyword class="operation">,</keyword> <keyword class="numbers">784</keyword><keyword class="braces">)</keyword> <keyword class="operation">-</keyword> <keyword class="numbers">0.5</keyword>
    biases_01 <keyword class="operation">=</keyword> <keyword class="from-class">np</keyword><keyword class="operation">.</keyword><keyword class="from-class">random</keyword><keyword class="operation">.</keyword><keyword class="function">rand</keyword><keyword class="braces">(</keyword><keyword class="numbers">10</keyword><keyword class="operation">,</keyword> <keyword class="numbers">1</keyword><keyword class="braces">)</keyword> <keyword class="operation">-</keyword> <keyword class="numbers">0.5</keyword>
    weights_02 <keyword class="operation">=</keyword> <keyword class="from-class">np</keyword><keyword class="operation">.</keyword><keyword class="from-class">random</keyword><keyword class="operation">.</keyword><keyword class="function">rand</keyword><keyword class="braces">(</keyword><keyword class="numbers">10</keyword><keyword class="operation">,</keyword> <keyword class="numbers">10</keyword><keyword class="braces">)</keyword> <keyword class="operation">-</keyword> <keyword class="numbers">0.5</keyword>
    biases_02 <keyword class="operation">=</keyword> <keyword class="from-class">np</keyword><keyword class="operation">.</keyword><keyword class="from-class">random</keyword><keyword class="operation">.</keyword><keyword class="function">rand</keyword><keyword class="braces">(</keyword><keyword class="numbers">10</keyword><keyword class="operation">,</keyword> <keyword class="numbers">1</keyword><keyword class="braces">)</keyword> <keyword class="operation">-</keyword> <keyword class="numbers">0.5</keyword>
    <keyword class="reserve-2">return</keyword> weights_01<keyword class="operation">,</keyword> biases_01<keyword class="operation">,</keyword> weights_02<keyword class="operation">,</keyword> biases_02
                    </code>
                </pre>
            </div>
            <p>
                Perform Forward Propagation.
            </p>
            <div class="code">
                <pre>
                    <code class="language-python">
<keyword class="comment"># Function for Forward Propagation</keyword>
<keyword class="reserve-1">def</keyword> <keyword class="function">forward_propagation</keyword><keyword class="braces">(</keyword>weights_01<keyword class="operation">,</keyword> biases_01<keyword class="operation">,</keyword> weights_02<keyword class="operation">,</keyword> biases_02<keyword class="operation">,</keyword> x<keyword class="braces">)</keyword><keyword class="operation">:</keyword>
    z1 <keyword class="operation">=</keyword> weights_01<keyword class="operation">.</keyword><keyword class="function">dot</keyword><keyword class="braces">(</keyword>x<keyword class="braces">)</keyword> <keyword class="operation">+</keyword> biases_01
    a1 <keyword class="operation">=</keyword> <keyword class="function">ReLU</keyword><keyword class="braces">(</keyword>z1<keyword class="braces">)</keyword>
    z2 <keyword class="operation">=</keyword> weights_02<keyword class="operation">.</keyword><keyword class="function">dot</keyword><keyword class="braces">(</keyword>a1<keyword class="braces">)</keyword> <keyword class="operation">+</keyword> biases_02
    a2 <keyword class="operation">=</keyword> <keyword class="function">softmax</keyword><keyword class="braces">(</keyword>z2<keyword class="braces">)</keyword>
    <keyword class="reserve-2">return</keyword> z1<keyword class="operation">,</keyword> a1<keyword class="operation">,</keyword> z2<keyword class="operation">,</keyword> a2
                    </code>
                </pre>
            </div>
            <p>
                Derivative of ReLU Activation and a Function for One Hot
                Encoding would be needed for Performing Back Propagation.
            </p>
            <div class="code">
                <pre>
                    <code class="language-python">
<keyword class="comment"># Derivative of Activation function ReLU</keyword>
<keyword class="reserve-1">def</keyword> <keyword class="function">ReLU_derivative</keyword><keyword class="braces">(</keyword>x<keyword class="braces">)</keyword><keyword class="operation">:</keyword>
    <keyword class="reserve-2">return</keyword> x <keyword class="operation">></keyword> <keyword class="numbers">0</keyword>


<keyword class="comment"># Function for One Hot Encoding</keyword>
<keyword class="reserve-1">def</keyword> <keyword class="function">one_hot</keyword><keyword class="braces">(</keyword>y<keyword class="braces">)</keyword><keyword class="operation">:</keyword>
    one_hot_y <keyword class="operation">=</keyword> <keyword class="from-class">np</keyword><keyword class="operation">.</keyword><keyword class="function">zeros</keyword><keyword class="braces">((</keyword>y<keyword class="operation">.</keyword>size<keyword class="operation">,</keyword> y<keyword class="operation">.</keyword><keyword class="function">max</keyword><keyword class="braces">()</keyword> <keyword class="operation">+</keyword> <keyword class="numbers">1</keyword><keyword class="braces">))</keyword>
    one_hot_y<keyword class="braces">[</keyword><keyword class="from-class">np</keyword><keyword class="operation">.</keyword><keyword class="function">arange</keyword><keyword class="braces">(</keyword>y<keyword class="operation">.</keyword>size<keyword class="braces">)</keyword><keyword class="operation">,</keyword> y<keyword class="braces">]</keyword> <keyword class="operation">=</keyword> 1
    one_hot_y <keyword class="operation">=</keyword> one_hot_y<keyword class="operation">.T</keyword>
    <keyword class="reserve-2">return</keyword> one_hot_y
                    </code>
                </pre>
            </div>
            <p>
                Perform Back Propagation.
            </p>
            <div class="code">
                <pre>
                    <code class="language-python">
<keyword class="comment"># Function for Back Propagation</keyword>
<keyword class="reserve-1">def</keyword> <keyword class="function">back_propagation</keyword><keyword class="braces">(</keyword>z1<keyword class="operation">,</keyword> a1<keyword class="operation">,</keyword> z2<keyword class="operation">,</keyword> a2<keyword class="operation">,</keyword> weights_01<keyword class="operation">,</keyword> weights_02<keyword class="operation">,</keyword> x<keyword class="operation">,</keyword> y<keyword class="braces">)</keyword><keyword class="operation">:</keyword>
    one_hot_y <keyword class="operation">=</keyword> one_hot<keyword class="braces">(</keyword>y<keyword class="braces">)</keyword>
    dz2 <keyword class="operation">=</keyword> a2 <keyword class="operation">-</keyword> one_hot_y
    dweights_02 <keyword class="operation">=</keyword> <keyword class="numbers">1</keyword> <keyword class="operation">/</keyword> m <keyword class="operation">*</keyword> dz2<keyword class="operation">.</keyword><keyword class="function">dot</keyword><keyword class="braces">(</keyword>a1<keyword class="operation">.T</keyword><keyword class="braces">)</keyword>
    dbiases_02 <keyword class="operation">=</keyword> <keyword class="numbers">1</keyword> <keyword class="operation">/</keyword> m <keyword class="operation">*</keyword> <keyword class="from-class">np</keyword><keyword class="operation">.</keyword><keyword class="function">sum</keyword><keyword class="braces">(</keyword>dz2<keyword class="braces">)</keyword>
    dz1 <keyword class="operation">=</keyword> weights_02<keyword class="operation">.T.</keyword><keyword class="function">dot</keyword><keyword class="braces">(</keyword>dz2<keyword class="braces">)</keyword> <keyword class="operation">*</keyword> <keyword class="function">ReLU_derivative</keyword><keyword class="braces">(</keyword>z1<keyword class="braces">)</keyword>
    dweights_01 <keyword class="operation">=</keyword> <keyword class="numbers">1</keyword> <keyword class="operation">/</keyword> m <keyword class="operation">*</keyword> dz1<keyword class="operation">.</keyword><keyword class="function">dot</keyword><keyword class="braces">(</keyword>x<keyword class="operation">.T</keyword><keyword class="braces">)</keyword>
    dbiases_01 <keyword class="operation">=</keyword> <keyword class="numbers">1</keyword> <keyword class="operation">/</keyword> m <keyword class="operation">*</keyword> <keyword class="from-class">np</keyword><keyword class="operation">.</keyword><keyword class="function">sum</keyword><keyword class="braces">(</keyword>dz1<keyword class="braces">)</keyword>
    <keyword class="reserve-2">return</keyword> dweights_01<keyword class="operation">,</keyword> dbiases_01<keyword class="operation">,</keyword> dweights_02<keyword class="operation">,</keyword> dbiases_02
                    </code>
                </pre>
            </div>
            <p>
                As we now have Derivatives of Weights and Biases,
                we can use them to Update Our Weights and Biases.
            </p>
            <div class="code">
                <pre>
                    <code class="language-python">
<keyword class="comment"># Function for Updating Parameters based on Derivatives of Weights and Biases Computed through Back Propagation</keyword>
<keyword class="reserve-1">def</keyword> <keyword class="function">update_parameters</keyword><keyword class="braces">(</keyword>weights_01<keyword class="operation">,</keyword> biases_01<keyword class="operation">,</keyword> weights_02<keyword class="operation">,</keyword> biases_02<keyword class="operation">,</keyword> dweights_01<keyword class="operation">,</keyword> dbiases_01<keyword class="operation">,</keyword> dweights_02<keyword class="operation">,</keyword> dbiases_02<keyword class="operation">,</keyword> alpha<keyword class="braces">)</keyword><keyword class="operation">:</keyword>
    weights_01 <keyword class="operation">=</keyword> weights_01 <keyword class="operation">-</keyword> alpha <keyword class="operation">*</keyword> dweights_01
    biases_01 <keyword class="operation">=</keyword> biases_01 <keyword class="operation">-</keyword> alpha <keyword class="operation">*</keyword> dbiases_01
    weights_02 <keyword class="operation">=</keyword> weights_02 <keyword class="operation">-</keyword> alpha <keyword class="operation">*</keyword> dweights_02
    biases_02 <keyword class="operation">=</keyword> biases_02 <keyword class="operation">-</keyword> alpha <keyword class="operation">*</keyword> dbiases_02
    <keyword class="reserve-2">return</keyword> weights_01<keyword class="operation">,</keyword> biases_01<keyword class="operation">,</keyword> weights_02<keyword class="operation">,</keyword> biases_02
                    </code>
                </pre>
            </div>
            <p>
                All we now have to do is repeat this process just enough times
                to get our Neural Network to Fit enough but not Overfit.
            </p>
            <p>
                Accuracy of the Network can also be monitored in between the Training Iterations.
                For that we will need a simple function that will get us all the predictions
                our Neural Network made, and also a simple function that can compare our
                predictions with the actual answers to calculate the accuracy of our predictions.
            </p>
            <div class="code">
                <pre>
                    <code class="language-python">
<keyword class="comment"># Function to get all Prediction Neural Network has made</keyword>
<keyword class="reserve-1">def</keyword> <keyword class="function">get_predictions(</keyword>A2<keyword class="braces">)</keyword><keyword class="operation">:</keyword>
    <keyword class="reserve-2">return</keyword> <keyword class="from-class">np</keyword><keyword class="operation">.</keyword><keyword class="function">argmax</keyword><keyword class="braces">(</keyword>A2<keyword class="operation">,</keyword> <keyword class="numbers">0</keyword><keyword class="braces">)</keyword>


<keyword class="comment"># Function to get Accuracy of Neural Network by comparing Predictions and Actual Answers</keyword>
<keyword class="reserve-1">def</keyword> <keyword class="function">get_accuracy</keyword><keyword class="braces">(</keyword>predictions<keyword class="operation">,</keyword> y<keyword class="braces">)</keyword><keyword class="operation">:</keyword>
    <keyword class="function">print</keyword><keyword class="braces">(</keyword>predictions<keyword class="operation">,</keyword> y<keyword class="braces">)</keyword>
    <keyword class="reserve-2">return</keyword> <keyword class="from-class">np</keyword><keyword class="operation">.</keyword><keyword class="function">sum</keyword><keyword class="braces">(</keyword>predictions <keyword class="operation">==</keyword> y<keyword class="braces">)</keyword> <keyword class="operation">/</keyword> y<keyword class="operation">.</keyword>size
                    </code>
                </pre>
            </div>
            <p>
                Now Accuracy of our Neural Network can be printed after
                every certain Number of Iterations during Training.
            </p>
            <div class="code">
                <pre>
                    <code class="language-python">
<keyword class="comment"># Initialize Parameters</keyword>
weights_01<keyword class="operation">,</keyword> biases_01<keyword class="operation">,</keyword> weights_02<keyword class="operation">,</keyword> biases_02 <keyword class="operation">=</keyword> <keyword class="function">init_parameters</keyword><keyword class="braces">()</keyword>
<keyword class="comment"># Iterating our Neural Network for Training</keyword>
for i in range<keyword class="braces">(</keyword>iterations<keyword class="braces">)</keyword><keyword class="operation">:</keyword>
    <keyword class="comment"># Forward Propagation</keyword>
    z1<keyword class="operation">,</keyword> a1<keyword class="operation">,</keyword> z2<keyword class="operation">,</keyword> a2 <keyword class="operation">=</keyword> <keyword class="function">forward_propagation</keyword><keyword class="braces">(</keyword>weights_01<keyword class="operation">,</keyword> biases_01<keyword class="operation">,</keyword> weights_02<keyword class="operation">,</keyword> biases_02<keyword class="operation">,</keyword> x<keyword class="braces">)</keyword>
    <keyword class="comment"># Back Propagation</keyword>
    dweights_01<keyword class="operation">,</keyword> dbiases_01<keyword class="operation">,</keyword> dweights_02<keyword class="operation">,</keyword> dbiases_02 <keyword class="operation">=</keyword> <keyword class="function">back_propagation</keyword><keyword class="braces">(</keyword>z1<keyword class="operation">,</keyword> a1<keyword class="operation">,</keyword> z2<keyword class="operation">,</keyword> a2<keyword class="operation">,</keyword> weights_01<keyword class="operation">,</keyword> weights_02<keyword class="operation">,</keyword> x<keyword class="operation">,</keyword> y<keyword class="braces">)</keyword>
    <keyword class="comment"># Updating Parameters</keyword>
    weights_01<keyword class="operation">,</keyword> biases_01<keyword class="operation">,</keyword> weights_02<keyword class="operation">,</keyword> biases_02 <keyword class="operation">=</keyword> <keyword class="function">update_parameters</keyword><keyword class="braces">(</keyword>weights_01<keyword class="operation">,</keyword> biases_01<keyword class="operation">,</keyword> weights_02<keyword class="operation">,</keyword> biases_02<keyword class="operation">,</keyword> dweights_01<keyword class="operation">,</keyword> dbiases_01<keyword class="operation">,</keyword> dweights_02<keyword class="operation">,</keyword> dbiases_02<keyword class="operation">,</keyword> alpha<keyword class="braces">)</keyword>
    <keyword class="comment"># After Every 50 Iterations</keyword>
    <keyword class="reserve-2">if</keyword> i <keyword class="operation">%</keyword> <keyword class="numbers">50</keyword> <keyword class="operation">==</keyword> <keyword class="numbers">0</keyword><keyword class="operation">:</keyword>
        <keyword class="comment"># Print Iteration Count and Accuracy our Neural Network has Achieved</keyword>
        <keyword class="function">print</keyword><keyword class="braces">(</keyword><keyword class="quotes">"Iteration: "</keyword><keyword class="operation">,</keyword> i<keyword class="braces">)</keyword>
        <keyword class="function">print</keyword><keyword class="braces">(</keyword><keyword class="quotes">"Accuracy: "</keyword><keyword class="operation">,</keyword> <keyword class="function">get_accuracy</keyword><keyword class="braces">(</keyword><keyword class="function">get_predictions</keyword><keyword class="braces">(</keyword>a2<keyword class="braces">)</keyword><keyword class="operation">,</keyword> y<keyword class="braces">))</keyword>
                    </code>
                </pre>
            </div>
            <h3>Storing the Parameters</h3>
            <p>
                Another thing I did in this project was to store the parameters
                of this Neural Network in a JSON file, and I used them in another Python File
                to test the accuracy of this Neural Network.
            </p>
            <div class="code">
                <pre>
                    <code class="language-python">
<keyword class="comment"># Storing the Parameters in JSON, so can be used for Testing in any Other Program</keyword>
<keyword class="comment"># (.tolist() function is used because Json can't store Numpy Arrays, for testing, it has to be converted into Numpy Arrays again)</keyword>
data <keyword class="operation">=</keyword> <keyword class="braces">{</keyword>
    <keyword class="quotes">"Weights-01"</keyword><keyword class="operation">:</keyword> weights_01.<keyword class="function">tolist</keyword><keyword class="braces">()</keyword><keyword class="operation">,</keyword>
    <keyword class="quotes">"Biases-01"</keyword><keyword class="operation">:</keyword> biases_01.<keyword class="function">tolist</keyword><keyword class="braces">()</keyword><keyword class="operation">,</keyword>
    <keyword class="quotes">"Weights-02"</keyword><keyword class="operation">:</keyword> weights_02.<keyword class="function">tolist</keyword><keyword class="braces">()</keyword><keyword class="operation">,</keyword>
    <keyword class="quotes">"Biases-02"</keyword><keyword class="operation">:</keyword> biases_02.<keyword class="function">tolist</keyword><keyword class="braces">()</keyword>
<keyword class="braces">}</keyword>
<keyword class="reserve-2">with</keyword> <keyword class="function">open</keyword><keyword class="braces">(</keyword><keyword class="quotes">"Parameters.json"</keyword><keyword class="operation">,</keyword> <keyword class="quotes">"w"</keyword><keyword class="braces">)</keyword> <keyword class="reserve-2">as</keyword> file<keyword class="operation">:</keyword>
    <keyword class="from-class">json</keyword><keyword class="operation">.</keyword><keyword class="function">dump</keyword><keyword class="braces">(</keyword>data<keyword class="operation">,</keyword> file<keyword class="braces">)</keyword>
                    </code>
                </pre>
            </div>
            <h3>Visualizing the Digits</h3>
            <p>
                I also wrote a small Python Program just to Visualize
                a random digit from the Dataset onto the Console.
            </p>
            <p>
                All it does is take the Dataset, convert it into a NumPy Array,
                select a random number from 0 to the length of the Dataset,
                and Draw the Digit of that Index onto the Console using different
                characters for different ranges of Brightness.
            </p>
            <div class="code">
                <pre>
                    <code class="language-python">
<keyword class="comment"># Selecting a Random Number as Index</keyword>
index <keyword class="operation">=</keyword> <keyword class="from-class">random</keyword><keyword class="operation">.</keyword><keyword class="function">randrange</keyword><keyword class="braces">(</keyword><keyword class="numbers">0</keyword><keyword class="operation">,</keyword> <keyword class="numbers">4997</keyword><keyword class="braces">)</keyword>

<keyword class="comment"># Drawing the Digit of that Index on the Console</keyword>
<keyword class="reserve-2">for</keyword> i <keyword class="reserve-2">in</keyword> <keyword class="from-class">range</keyword><keyword class="braces">(</keyword><keyword class="numbers">1</keyword><keyword class="operation">,</keyword> <keyword class="numbers">785</keyword><keyword class="braces">)</keyword><keyword class="operation">:</keyword>
    <keyword class="reserve-2">if</keyword> data<keyword class="braces">[</keyword>index<keyword class="braces">]</keyword><keyword class="braces">[</keyword>i<keyword class="braces">]</keyword> <keyword class="operation">>=</keyword> <keyword class="numbers">0</keyword> <keyword class="reserve-1">and</keyword> data<keyword class="braces">[</keyword>index<keyword class="braces">]</keyword><keyword class="braces">[</keyword>i<keyword class="braces">]</keyword> <keyword class="operation"><=</keyword> <keyword class="numbers">30</keyword><keyword class="operation">:</keyword>
        <keyword class="function">print</keyword><keyword class="braces">(</keyword><keyword class="quotes">" "</keyword><keyword class="operation">,</keyword> end<keyword class="operation">=</keyword><keyword class="quotes">" "</keyword><keyword class="braces">)</keyword>
    <keyword class="reserve-2">elif</keyword> data<keyword class="braces">[</keyword>index<keyword class="braces">]</keyword><keyword class="braces">[</keyword>i<keyword class="braces">]</keyword> <keyword class="operation">>=</keyword> <keyword class="numbers">31</keyword> <keyword class="reserve-1">and</keyword> data<keyword class="braces">[</keyword>index<keyword class="braces">]</keyword><keyword class="braces">[</keyword>i<keyword class="braces">]</keyword> <keyword class="operation"><=</keyword> <keyword class="numbers">60</keyword><keyword class="operation">:</keyword>
        <keyword class="function">print</keyword><keyword class="braces">(</keyword><keyword class="quotes">"."</keyword><keyword class="operation">,</keyword> end<keyword class="operation">=</keyword><keyword class="quotes">" "</keyword><keyword class="braces">)</keyword>
    <keyword class="reserve-2">elif</keyword> data<keyword class="braces">[</keyword>index<keyword class="braces">]</keyword><keyword class="braces">[</keyword>i<keyword class="braces">]</keyword> <keyword class="operation">>=</keyword> <keyword class="numbers">61</keyword> <keyword class="reserve-1">and</keyword> data<keyword class="braces">[</keyword>index<keyword class="braces">]</keyword><keyword class="braces">[</keyword>i<keyword class="braces">]</keyword> <keyword class="operation"><=</keyword> <keyword class="numbers">90</keyword><keyword class="operation">:</keyword>
        <keyword class="function">print</keyword><keyword class="braces">(</keyword><keyword class="quotes">","</keyword><keyword class="operation">,</keyword> end<keyword class="operation">=</keyword><keyword class="quotes">" "</keyword><keyword class="braces">)</keyword>
    <keyword class="reserve-2">elif</keyword> data<keyword class="braces">[</keyword>index<keyword class="braces">]</keyword><keyword class="braces">[</keyword>i<keyword class="braces">]</keyword> <keyword class="operation">>=</keyword> <keyword class="numbers">91</keyword> <keyword class="reserve-1">and</keyword> data<keyword class="braces">[</keyword>index<keyword class="braces">]</keyword><keyword class="braces">[</keyword>i<keyword class="braces">]</keyword> <keyword class="operation"><=</keyword> <keyword class="numbers">120</keyword><keyword class="operation">:</keyword>
        <keyword class="function">print</keyword><keyword class="braces">(</keyword><keyword class="quotes">"`"</keyword><keyword class="operation">,</keyword> end<keyword class="operation">=</keyword><keyword class="quotes">" "</keyword><keyword class="braces">)</keyword>
    <keyword class="reserve-2">elif</keyword> data<keyword class="braces">[</keyword>index<keyword class="braces">]</keyword><keyword class="braces">[</keyword>i<keyword class="braces">]</keyword> <keyword class="operation">>=</keyword> <keyword class="numbers">121</keyword> <keyword class="reserve-1">and</keyword> data<keyword class="braces">[</keyword>index<keyword class="braces">]</keyword><keyword class="braces">[</keyword>i<keyword class="braces">]</keyword> <keyword class="operation"><=</keyword> <keyword class="numbers">150</keyword><keyword class="operation">:</keyword>
        <keyword class="function">print</keyword><keyword class="braces">(</keyword><keyword class="quotes">"*"</keyword><keyword class="operation">,</keyword> end<keyword class="operation">=</keyword><keyword class="quotes">" "</keyword><keyword class="braces">)</keyword>
    <keyword class="reserve-2">elif</keyword> data<keyword class="braces">[</keyword>index<keyword class="braces">]</keyword><keyword class="braces">[</keyword>i<keyword class="braces">]</keyword> <keyword class="operation">>=</keyword> <keyword class="numbers">151</keyword> <keyword class="reserve-1">and</keyword> data<keyword class="braces">[</keyword>index<keyword class="braces">]</keyword><keyword class="braces">[</keyword>i<keyword class="braces">]</keyword> <keyword class="operation"><=</keyword> <keyword class="numbers">180</keyword><keyword class="operation">:</keyword>
        <keyword class="function">print</keyword><keyword class="braces">(</keyword><keyword class="quotes">"!"</keyword><keyword class="operation">,</keyword> end<keyword class="operation">=</keyword><keyword class="quotes">" "</keyword><keyword class="braces">)</keyword>
    <keyword class="reserve-2">elif</keyword> data<keyword class="braces">[</keyword>index<keyword class="braces">]</keyword><keyword class="braces">[</keyword>i<keyword class="braces">]</keyword> <keyword class="operation">>=</keyword> <keyword class="numbers">181</keyword> <keyword class="reserve-1">and</keyword> data<keyword class="braces">[</keyword>index<keyword class="braces">]</keyword><keyword class="braces">[</keyword>i<keyword class="braces">]</keyword> <keyword class="operation"><=</keyword> <keyword class="numbers">210</keyword><keyword class="operation">:</keyword>
        <keyword class="function">print</keyword><keyword class="braces">(</keyword><keyword class="quotes">"#"</keyword><keyword class="operation">,</keyword> end<keyword class="operation">=</keyword><keyword class="quotes">" "</keyword><keyword class="braces">)</keyword>
    <keyword class="reserve-2">elif</keyword> data<keyword class="braces">[</keyword>index<keyword class="braces">]</keyword><keyword class="braces">[</keyword>i<keyword class="braces">]</keyword> <keyword class="operation">>=</keyword> <keyword class="numbers">211</keyword><keyword class="operation">:</keyword>
        <keyword class="function">print</keyword><keyword class="braces">(</keyword><keyword class="quotes">"@"</keyword><keyword class="operation">,</keyword> end<keyword class="operation">=</keyword><keyword class="quotes">" "</keyword><keyword class="braces">)</keyword>
    <keyword class="reserve-2">if</keyword> <keyword class="braces">(</keyword>i <keyword class="operation">-</keyword> <keyword class="numbers">0</keyword><keyword class="braces">)</keyword> <keyword class="operation">%</keyword> <keyword class="numbers">28</keyword> <keyword class="operation">==</keyword> <keyword class="numbers">0</keyword><keyword class="operation">:</keyword>
        <keyword class="function">print</keyword><keyword class="braces">(</keyword><keyword class="quotes">" "</keyword><keyword class="braces">)</keyword>
                    </code>
                </pre>
            </div>
            <h3>Testing the Accuracy</h3>
            <p>
                I wrote a different Python file to test the accuracy of the Neural Network,
                in that file I initially imported the Parameters from our JSON file
                and turned them into NumPy Arrays.
            </p>
            <div class="code">
                <pre>
                    <code class="language-python">
<keyword class="comment"># Importing Stored Parameters from Json File</keyword>
<keyword class="reserve-2">with</keyword> <keyword class="function">open</keyword><keyword class="braces">(</keyword><keyword class="quotes">"Parameters.json"</keyword><keyword class="operation">,</keyword> <keyword class="quotes">"r"</keyword><keyword class="braces">)</keyword> <keyword class="reserve-2">as</keyword> file<keyword class="operation">:</keyword>
    parameters <keyword class="operation">=</keyword> <keyword class="from-class">json</keyword><keyword class="operation">.</keyword><keyword class="function">load</keyword><keyword class="braces">(</keyword>file<keyword class="braces">)</keyword>

<keyword class="comment"># Extracting Weights and Biases from JSON lists</keyword>
weights_01 <keyword class="operation">=</keyword> parameters<keyword class="braces">[</keyword><keyword class="quotes">"Weights-01"</keyword><keyword class="braces">]</keyword>
biases_01 <keyword class="operation">=</keyword> parameters<keyword class="braces">[</keyword><keyword class="quotes">"Biases-01"</keyword><keyword class="braces">]</keyword>
weights_02 <keyword class="operation">=</keyword> parameters<keyword class="braces">[</keyword><keyword class="quotes">"Weights-02"</keyword><keyword class="braces">]</keyword>
biases_02 <keyword class="operation">=</keyword> parameters<keyword class="braces">[</keyword><keyword class="quotes">"Biases-02"</keyword><keyword class="braces">]</keyword>

<keyword class="comment"># Turning our Weights and Biases into Numpy Arrays</keyword>
weights_01 <keyword class="operation">=</keyword> <keyword class="from-class">np</keyword><keyword class="operation">.</keyword><keyword class="function">array</keyword><keyword class="braces">(</keyword>weights_01<keyword class="braces">)</keyword>
biases_01 <keyword class="operation">=</keyword> <keyword class="from-class">np</keyword><keyword class="operation">.</keyword><keyword class="function">array</keyword><keyword class="braces">(</keyword>biases_01<keyword class="braces">)</keyword>
weights_02 <keyword class="operation">=</keyword> <keyword class="from-class">np</keyword><keyword class="operation">.</keyword><keyword class="function">array</keyword><keyword class="braces">(</keyword>weights_02<keyword class="braces">)</keyword>
biases_02 <keyword class="operation">=</keyword> <keyword class="from-class">np</keyword><keyword class="operation">.</keyword><keyword class="function">array</keyword><keyword class="braces">(</keyword>biases_02<keyword class="braces">)</keyword>
                    </code>
                </pre>
            </div>
            <p>
                Import the Test Data from a different CSV file, convert it into a NumPy Array,
                shuffle it, and select only the first one Digit to test our Neural Network.
            </p>
            <div class="code">
                <pre>
                    <code class="language-python">
<keyword class="comment"># Importing the Dataset for Testing</keyword>
test_data <keyword class="operation">=</keyword> <keyword class="from-class">pd</keyword><keyword class="operation">.</keyword><keyword class="function">read_csv</keyword><keyword class="braces">(</keyword><keyword class="quotes">'Data/mnist_test.csv'</keyword><keyword class="braces">)</keyword>


<keyword class="comment"># Turn Dataset into Numpy Array and Shuffling it</keyword>
test_data <keyword class="operation">=</keyword> <keyword class="from-class">np</keyword><keyword class="operation">.</keyword><keyword class="function">array</keyword><keyword class="braces">(</keyword>test_data<keyword class="braces">)</keyword>
m<keyword class="operation">,</keyword> n <keyword class="operation">=</keyword> test_data<keyword class="operation">.</keyword>shape
<keyword class="from-class">np</keyword><keyword class="operation">.</keyword><keyword class="from-class">random</keyword><keyword class="operation">.</keyword><keyword class="function">shuffle</keyword><keyword class="braces">(</keyword>test_data<keyword class="braces">)</keyword>


<keyword class="comment"># Selecting one Digit from the Shuffled Dataset</keyword>
data_test <keyword class="operation">=</keyword> test_data <keyword class="braces">[</keyword><keyword class="numbers">0</keyword><keyword class="operation">:</keyword><keyword class="numbers">1</keyword><keyword class="braces">]</keyword><keyword class="operation">.T</keyword>
Y_test <keyword class="operation">=</keyword> data_test <keyword class="braces">[</keyword><keyword class="numbers">0</keyword><keyword class="braces">]</keyword>
X_test <keyword class="operation">=</keyword> data_test <keyword class="braces">[</keyword><keyword class="numbers">1</keyword><keyword class="operation">:</keyword><keyword class="numbers">n</keyword><keyword class="braces">]</keyword>
X_test <keyword class="operation">=</keyword> X_test <keyword class="operation">/</keyword> <keyword class="numbers">255</keyword>
                    </code>
                </pre>
            </div>
            <p>
                We will also need the Activation functions from the Main file,
                and use them to perform Forward Propagation.
            </p>
            <div class="code">
                <pre>
                    <code class="language-python">
<keyword class="comment"># Activation Function Rectified Linear Unit (ReLU)</keyword>
<keyword class="reserve-1">def</keyword> <keyword class="function">ReLU</keyword><keyword class="braces">(</keyword>x<keyword class="braces">)</keyword><keyword class="operation">:</keyword>
    <keyword class="reserve-2">return</keyword> <keyword class="from-class">np</keyword><keyword class="operation">.</keyword><keyword class="function">maximum</keyword><keyword class="braces">(</keyword>x<keyword class="operation">,</keyword> <keyword class="numbers">0</keyword><keyword class="braces">)</keyword>


<keyword class="comment"># Activation Function Softmax</keyword>
<keyword class="reserve-1">def</keyword> <keyword class="function">softmax</keyword><keyword class="braces">(</keyword>z<keyword class="braces">)</keyword><keyword class="operation">:</keyword>
    a <keyword class="operation">=</keyword> <keyword class="from-class">np</keyword><keyword class="operation">.</keyword><keyword class="function">exp</keyword><keyword class="braces">(</keyword>z<keyword class="braces">)</keyword> <keyword class="operation">/</keyword> <keyword class="function">sum</keyword><keyword class="braces">(</keyword><keyword class="from-class">np</keyword><keyword class="operation">.</keyword><keyword class="function">exp</keyword><keyword class="braces">(</keyword>z<keyword class="braces">))</keyword>
    <keyword class="reserve-2">return</keyword> a


<keyword class="comment"># Forward Propagating the Input</keyword>
z1 <keyword class="operation">=</keyword> weights_01<keyword class="operation">.</keyword><keyword class="function">dot</keyword><keyword class="braces">(</keyword>X_test<keyword class="braces">)</keyword> <keyword class="operation">+</keyword> biases_01
a1 <keyword class="operation">=</keyword> <keyword class="function">ReLU</keyword><keyword class="braces">(</keyword>z1<keyword class="braces">)</keyword>
z2 <keyword class="operation">=</keyword> weights_02<keyword class="operation">.</keyword><keyword class="function">dot</keyword><keyword class="braces">(</keyword>a1<keyword class="braces">)</keyword> <keyword class="operation">+</keyword> biases_02
a2 <keyword class="operation">=</keyword> <keyword class="function">softmax</keyword><keyword class="braces">(</keyword>z2<keyword class="braces">)</keyword>
                    </code>
                </pre>
            </div>
            <p>
                Simply Calculate the Digit with the Highest Probability,
                print the probability of each Digit, and print the Digit with
                the Highest Probability as the Response of our Neural Network.
            </p>
            <div class="code">
                <pre>
                    <code class="language-python">
<keyword class="comment"># Finding the index of Highest Probability after Forward Propagation</keyword>
max_val <keyword class="operation">=</keyword> a2<keyword class="braces">[</keyword><keyword class="numbers">0</keyword><keyword class="braces">]</keyword>
index <keyword class="operation">=</keyword> <keyword class="numbers">0</keyword>
<keyword class="reserve-2">for</keyword> i <keyword class="reserve-2">in</keyword> range<keyword class="braces">(</keyword><keyword class="function">len</keyword><keyword class="braces">(</keyword>a2<keyword class="braces">))</keyword><keyword class="operation">:</keyword>
    <keyword class="reserve-2">if</keyword> a2<keyword class="braces">[</keyword>i<keyword class="braces">]</keyword> <keyword class="operation">>=</keyword> max_val<keyword class="operation">:</keyword>
        index <keyword class="operation">=</keyword> i
        max_val <keyword class="operation">=</keyword> a2<keyword class="braces">[</keyword>i<keyword class="braces">]</keyword>


<keyword class="comment"># Listing the Probability of Each Digit being the Answer</keyword>
<keyword class="reserve-2">for</keyword> i <keyword class="reserve-2">in</keyword> range<keyword class="braces">(</keyword><keyword class="numbers">0</keyword><keyword class="operation">,</keyword> <keyword class="numbers">10</keyword><keyword class="braces">)</keyword><keyword class="operation">:</keyword>
    <keyword class="function">print</keyword><keyword class="braces">(</keyword><keyword class="quotes">"Probability of "</keyword><keyword class="operation">,</keyword> i<keyword class="operation">,</keyword> <keyword class="quotes">" is <keyword class="reserve-1">%.2f</keyword> percent"</keyword> <keyword class="operation">%</keyword> <keyword class="braces">(</keyword>a2<keyword class="braces">[</keyword>i<keyword class="braces">][</keyword><keyword class="numbers">0</keyword><keyword class="braces">]</keyword> <keyword class="operation">*</keyword> <keyword class="numbers">100</keyword><keyword class="braces">))</keyword>


<keyword class="comment"># Printing the Prediction of our Neural Network</keyword>
<keyword class="function">print</keyword></keyword><keyword class="braces">(</keyword><keyword class="quotes">"I think it is a "</keyword><keyword class="operation">,</keyword> index<keyword class="braces">)</keyword>
                    </code>
                </pre>
            </div>
            <p>
                We can also Draw the Digit on the Console before showing
                us the probabilities of the answer in the same way we did before.
            </p>
            <p>
                Here are a few examples of Predictions that the Neural Network has made.
            </p>
            <img src="../images/Neural-Network-Prediction-00.png" alt="" class="image">
            <img src="../images/Neural-Network-Prediction-01.png" alt="" class="image">
            <img src="../images/Neural-Network-Prediction-02.png" alt="" class="image">
            <p>Here the Network seems to question a little whether it's a 7 or a 9.</p>
            <img src="../images/Neural-Network-Prediction-03.png" alt="" class="image">
            <p>Confused here about a 5 and a 6.</p>
            <img src="../images/Neural-Network-Prediction-04.png" alt="" class="image">
            <p>Another confusion here between a 7 and a 9.</p>
            <img src="../images/Neural-Network-Prediction-05.png" alt="" class="image">
            <p>Here it seems to consider 4, 5, and 6 a considerable possibility.</p>
            <p>
                Most of the Digits I have seen it answer to are mostly
                Accurate other than a few that are distorted quite a bit.
            </p>
        </div>
    </div>
    <script src="../../script.js"></script>
</body>
</html>